(this.webpackJsonpsocialnetwork_laboratoria=this.webpackJsonpsocialnetwork_laboratoria||[]).push([[0],{114:function(e,t,a){e.exports=a(143)},119:function(e,t,a){},125:function(e,t,a){},137:function(e,t,a){},138:function(e,t,a){},139:function(e,t,a){},140:function(e,t,a){},142:function(e,t,a){},143:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),s=a(13),o=a.n(s),c=(a(119),a(31)),l=a(10),u=a(66);function d(e){return{type:n.LOGIN,userAuthenticated:e}}function m(e){var t=b.getState().posts;return t.push(e),{type:n.CREATE_POST,posts:t}}function p(e){return{type:n.REFRESH_POSTS,posts:e}}function h(e){var t=b.getState().posts,a=t.indexOf(e);return t[a]=e,{type:n.UPDATE_POST,posts:t}}function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}!function(e){e[e.LOGIN=0]="LOGIN",e[e.LOGOFF=1]="LOGOFF",e[e.CREATE_POST=2]="CREATE_POST",e[e.REFRESH_POSTS=3]="REFRESH_POSTS",e[e.DELETE_POST=4]="DELETE_POST",e[e.UPDATE_POST=5]="UPDATE_POST"}(n||(n={}));var g={userAuthenticated:void 0,posts:new Array};var E,b=Object(u.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.LOGIN:return v({},e,{userAuthenticated:t.userAuthenticated});case n.LOGOFF:return v({},e,{userAuthenticated:void 0});case n.CREATE_POST:case n.REFRESH_POSTS:case n.DELETE_POST:case n.UPDATE_POST:return v({},e,{posts:t.posts});default:return e}})),P=a(71),O=a(43),S=a(11),y=a(12),w=a(28),T=a(29),k=a(32),N=(a(76),a(101)),A=a(209),C=a(197),I=a(9),x=a.n(I),L=a(16),R=a(194),F=a(196),D=a(212),j=(a(125),a(214)),M=a(144),U=a(93),_=a.n(U),B=a(92),H=a.n(B),W=a(91),V=a.n(W),G=a(89),q=a.n(G),Z=a(90),X=a.n(Z);function z(e){var t,a=e.text,n=e.handleClose,r=e.variant,s=e.show;switch(r){case E.WARNING:t=i.a.createElement(q.a,null);break;case E.SUCCESS:t=i.a.createElement(X.a,null);break;case E.ERROR:t=i.a.createElement(V.a,null);break;case E.INFO:t=i.a.createElement(H.a,null)}return i.a.createElement(j.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:s,autoHideDuration:8e3,onClose:n,ContentProps:{"aria-describedby":"message-id"},message:i.a.createElement("span",{id:"message-id",className:"message"},t,a),action:[i.a.createElement(M.a,{key:"close","aria-label":"close",color:"inherit",className:"close",onClick:n},i.a.createElement(_.a,null))],className:"SnackBar "+r})}!function(e){e.WARNING="warning",e.SUCCESS="success",e.ERROR="error",e.INFO="info"}(E||(E={}));var Y=function(){function e(){Object(S.a)(this,e)}return Object(y.a)(e,null,[{key:"validateEmail",value:function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}},{key:"formatDate",value:function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.getFullYear(),r=e.completeLeadingZeros((t.getMonth()+1).toString(),2),i=e.completeLeadingZeros(t.getDate().toString(),2),s="";return a&&(s=" "+this.formatHour(t)),i+"/"+r+"/"+n+s}},{key:"formatHour",value:function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.completeLeadingZeros(t.getHours().toString(),2),r=e.completeLeadingZeros(t.getMinutes().toString(),2),i=a?":"+e.completeLeadingZeros(t.getSeconds().toString(),2):"";return n+":"+r+i}},{key:"getMidnightTime",value:function(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}},{key:"translateDateToText",value:function(e){var t=e;return this.getMidnightTime(e).valueOf()===this.getMidnightTime(new Date).valueOf()?"Today at "+this.formatHour(t):""}},{key:"completeLeadingZeros",value:function(e,t){for(var a="",n=0;n<t;n++)a="0"+a;return(a+e).slice(-t)}}]),e}(),J=a(61),K=a.n(J),Q=function e(){Object(S.a)(this,e)};function $(){for(var e=0;e<K.a.apps.length;e++)if("[DEFAULT]"===K.a.apps[e].name)return;K.a.initializeApp(Q.firebaseConfig)}Q.firebaseConfig={apiKey:"AIzaSyDS1v5erkI8ArkEpO_NoEDRv4wcDDLIu5I",authDomain:"socialnetwork-d9478.firebaseapp.com",databaseURL:"https://socialnetwork-d9478.firebaseio.com",projectId:"socialnetwork-d9478",storageBucket:"socialnetwork-d9478.appspot.com",messagingSenderId:"1077042299179",appId:"1:1077042299179:web:4048574ca3f2bcffa4456e"};var ee,te=K.a,ae=function(){function e(){Object(S.a)(this,e)}return Object(y.a)(e,null,[{key:"createUser",value:function(e,t){return $(),new Promise((function(a,n){te.auth().createUserWithEmailAndPassword(e,t).then((function(e){a(e)})).catch((function(e){n(e)}))}))}},{key:"loginUser",value:function(e,t){return $(),new Promise((function(a,n){te.auth().signInWithEmailAndPassword(e,t).then((function(e){a(e)})).catch((function(e){n(e)}))}))}},{key:"resetPassword",value:function(){var e=Object(L.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(),e.next=3,te.auth().sendPasswordResetEmail(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();!function(e){e[e.MALE=0]="MALE",e[e.FEMALE=1]="FEMALE",e[e.NOT_INFORM=2]="NOT_INFORM"}(ee||(ee={}));var ne,re=function(){function e(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";Object(S.a)(this,e),this.id="",this.email=void 0,this.firstName=void 0,this.lastName=void 0,this.gender=void 0,this.friends=void 0,this.hasImage=void 0,this._friends=void 0,this.email=t,this.firstName=a,this.gender=n,this.lastName=r,this.friends=new Array,this._friends=new Array,this.hasImage=!1}return Object(y.a)(e,[{key:"getFirstLetter",value:function(){return this.firstName[0]}},{key:"getFullName",value:function(){return this.firstName+" "+this.lastName}},{key:"getUpdatable",value:function(){return{id:this.id,email:this.email,firstName:this.firstName,lastName:this.lastName,gender:this.gender,friends:this._friends,hasImage:this.hasImage}}}],[{key:"getUser",value:function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.id,r=t.email,i=t.firstName,s=t.lastName,o=t.gender,c=t.friends?Object.keys(t.requests).map((function(e){return t.friends[e]})):new Array,l=new Array,u=t.hasImage;a&&(l=new Array);var d=new e(r,i,o,s);return d.id=n,d._friends=c,d.friends=l,d.hasImage=u,d}}]),e}(),ie=function(){function e(){Object(S.a)(this,e)}return Object(y.a)(e,null,[{key:"createUser",value:function(){var e=Object(L.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(),e.next=3,te.database().ref("users/"+t.id).update(t.getUpdatable());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUser",value:function(e){return $(),new Promise((function(t,a){te.database().ref("users/"+e).once("value",(function(e){var a=re.getUser(e.exportVal());t(a)}))}))}}]),e}(),se=a(195);!function(e){e[e.EMAIL=0]="EMAIL",e[e.FIRSTNAME=1]="FIRSTNAME",e[e.LASTNAME=2]="LASTNAME",e[e.PASSWORD=3]="PASSWORD",e[e.SEX=4]="SEX",e[e.BIRHTDAY=5]="BIRHTDAY"}(ne||(ne={}));var oe,ce=function(e){function t(e){var a;for(var n in Object(S.a)(this,t),(a=Object(w.a)(this,Object(T.a)(t).call(this,e))).errorMessages=new Map,a.componentWillMount=function(){var e=localStorage.getItem("@SocialNetwork/uid");e&&a.loginUser(e)},a.displayError=function(e){return a.displayHelperText(e).length>0},a.setHelpersText=function(){var e=a.state,t=e.email,n=e.password,r="";r="",Y.validateEmail(t)||(r="Email address is not valid"),a.errorMessages.set(ne.EMAIL,r),r="",0===n.length&&(r="Password is required"),a.errorMessages.set(ne.PASSWORD,r)},a.displayHelperText=function(e){return a.state.submitted?a.errorMessages.get(e):""},a.handleLogin=Object(L.a)(x.a.mark((function e(){var t,n,r,i,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({submitted:!0}),t=!1,a.errorMessages.forEach((function(e,a){t||(t=e.length>0)})),t||(n=a.state,r=n.email,i=n.password,s=n.keepConnected,ae.loginUser(r,i).then((function(e){s?localStorage.setItem("@SocialNetwork/uid",e.user.uid):localStorage.removeItem("@SocialNetwork/uid"),a.loginUser(e.user.uid)})).catch(function(){var e=Object(L.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({snackBarText:t.message});case 2:a.setState({showSnackBar:!0});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)}))),a.loginUser=function(e){ie.getUser(e).then((function(e){a.props.dispatch(d(e))}))},a.handleClose=function(){return a.setState({showSnackBar:!1})},a.state={submitted:!1,email:"",password:"",showSnackBar:!1,snackBarText:"",keepConnected:!0},ne)a.errorMessages.set(parseInt(n),"");return a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.email,n=t.password,r=t.showSnackBar,s=t.snackBarText,o=t.keepConnected;return this.setHelpersText(),i.a.createElement("div",{className:"componentContainer componentLoginContainer"},i.a.createElement("div",{className:"componentWelcome"},"Good to see you again. Welcome!"),i.a.createElement(z,{variant:E.ERROR,handleClose:this.handleClose,show:r,text:s}),i.a.createElement("form",{className:"componentForm componentLoginForm"},i.a.createElement(R.a,{required:!0,error:this.displayError(ne.EMAIL),value:a,onChange:function(t){return e.setState({email:t.target.value})},id:"email",label:"E-mail",helperText:this.displayHelperText(ne.EMAIL),variant:"outlined"}),i.a.createElement(R.a,{required:!0,error:this.displayError(ne.PASSWORD),value:n,onChange:function(t){return e.setState({password:t.target.value})},id:"password",label:"Password",type:"password",helperText:this.displayHelperText(ne.PASSWORD),variant:"outlined"}),i.a.createElement(se.a,{control:i.a.createElement(D.a,{checked:o,onChange:function(t){return e.setState({keepConnected:t.target.checked})},value:o,color:"primary"}),label:"Keep connected"})),i.a.createElement("div",{className:"formSubmit"},i.a.createElement(F.a,{variant:"contained",color:"primary",className:"submitButton",onClick:this.handleLogin},"Login")))}}]),t}(r.Component),le=Object(c.b)((function(e){return{userAuthenticated:e.userAuthenticated}}))(ce),ue=a(215),de=a(148),me=a(147),pe=a(149),he=a(150),fe=function(){function e(){Object(S.a)(this,e)}return Object(y.a)(e,null,[{key:"uploadImage",value:function(e,t){$();var a=te.storage().ref().child(e);return new Promise((function(e){a.put(t).then((function(){e()}))}))}},{key:"uploadUserImage",value:function(e,t){return this.uploadImage("users/"+e,t)}},{key:"uploadPostImage",value:function(e,t){return this.uploadImage("posts/"+e,t)}},{key:"downloadImage",value:function(e){$();var t=te.storage().ref().child(e);return new Promise((function(e){t.getDownloadURL().then((function(t){e(t)}))}))}},{key:"downloadUserImage",value:function(e){return this.downloadImage("users/"+e)}},{key:"downloadPostImage",value:function(e){return this.downloadImage("posts/"+e)}},{key:"deleteImage",value:function(e){$();var t=te.storage().ref().child(e);return new Promise((function(e){t.delete().then((function(){e()}))}))}},{key:"deletePostImage",value:function(e){return this.deleteImage("posts/"+e)}}]),e}(),ve=a(53),ge=a.n(ve),Ee=a(50),be=a.n(Ee);!function(e){e[e.EMAIL=0]="EMAIL",e[e.FIRSTNAME=1]="FIRSTNAME",e[e.LASTNAME=2]="LASTNAME",e[e.PASSWORD=3]="PASSWORD",e[e.SEX=4]="SEX"}(oe||(oe={}));var Pe,Oe=function(e){function t(e){var a;for(var n in Object(S.a)(this,t),(a=Object(w.a)(this,Object(T.a)(t).call(this,e))).errorMessages=new Map,a.displayError=function(e){return a.displayHelperText(e).length>0},a.setHelpersText=function(){var e=a.state,t=e.email,n=e.password,r=e.firstName,i="";i="",Y.validateEmail(t)||(i="Email address is not valid"),a.errorMessages.set(oe.EMAIL,i),i="",0===r.length&&(i="First Name Required"),a.errorMessages.set(oe.FIRSTNAME,i),i="",0===n.length&&(i="Password is required"),a.errorMessages.set(oe.PASSWORD,i)},a.displayHelperText=function(e){return a.state.submitted?a.errorMessages.get(e):""},a.handleRegister=Object(L.a)(x.a.mark((function e(){var t,n,r,i,s,o,c,l,u;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({submitted:!0}),t=!1,a.errorMessages.forEach((function(e,a){t||(t=e.length>0)})),t||(n=a.state,r=n.email,i=n.password,s=n.firstName,o=n.lastName,c=n.sex,l=n.pictureFile,u=new re(r,s,c,o),ae.createUser(r,i).then(function(){var e=Object(L.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.id=t.user.uid,l&&(fe.uploadUserImage(u.id,l),u.hasImage=!0),e.next=4,ie.createUser(u);case 4:a.props.dispatch(d(u));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(function(){var e=Object(L.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({snackBarText:t.message});case 2:a.setState({showSnackBar:!0});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)}))),a.handleClose=function(){return a.setState({showSnackBar:!1})},a.handleImageSelected=function(e){if(e){var t=new FileReader;t.onloadend=function(){a.setState({pictureFile:e,picturePreviewURL:t.result})},t.readAsDataURL(e)}},a.handleRemoveProfilePicture=function(){a.setState({pictureFile:void 0,picturePreviewURL:""})},a.state={submitted:!1,email:"",firstName:"",lastName:"",password:"",sex:ee.NOT_INFORM,showSnackBar:!1,snackBarText:"",pictureFile:void 0,picturePreviewURL:""},oe)a.errorMessages.set(parseInt(n),"");return a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.email,n=t.password,r=t.firstName,s=t.lastName,o=t.sex,c=t.showSnackBar,l=t.snackBarText,u=t.picturePreviewURL;return this.setHelpersText(),i.a.createElement("div",{className:"componentContainer"},i.a.createElement("div",{className:"componentWelcome"},"Welcome to mine, yours, our Social Network!"),i.a.createElement(z,{variant:E.ERROR,handleClose:this.handleClose,show:c,text:l}),i.a.createElement("form",{className:"componentForm"},i.a.createElement(R.a,{required:!0,error:this.displayError(oe.EMAIL),value:a,onChange:function(t){return e.setState({email:t.target.value})},id:"email",label:"E-mail",helperText:this.displayHelperText(oe.EMAIL),variant:"outlined"}),i.a.createElement(R.a,{required:!0,error:this.displayError(oe.PASSWORD),value:n,onChange:function(t){return e.setState({password:t.target.value})},id:"password",label:"Password",type:"password",helperText:this.displayHelperText(oe.PASSWORD),variant:"outlined"}),i.a.createElement(R.a,{required:!0,error:this.displayError(oe.FIRSTNAME),value:r,onChange:function(t){return e.setState({firstName:t.target.value})},id:"firstName",label:"First name",helperText:this.displayHelperText(oe.FIRSTNAME),variant:"outlined"}),i.a.createElement(R.a,{id:"lastName",value:s,onChange:function(t){return e.setState({lastName:t.target.value})},error:this.displayError(oe.LASTNAME),label:"Last name",helperText:this.displayHelperText(oe.LASTNAME),variant:"outlined"}),i.a.createElement(me.a,{variant:"outlined",error:this.displayError(oe.SEX)},i.a.createElement(he.a,{id:"demo-simple-select-error-label"},"Gender"),i.a.createElement(pe.a,{labelId:"demo-simple-select-error-label",id:"demo-simple-select-error",value:o,onChange:function(t){return e.setState({sex:t.target.value})}},i.a.createElement(ue.a,{value:ee.MALE},"Male"),i.a.createElement(ue.a,{value:ee.FEMALE},"Female"),i.a.createElement(ue.a,{value:ee.NOT_INFORM},"Not informed")),i.a.createElement(de.a,null,this.displayHelperText(oe.SEX))),i.a.createElement("div",{className:"profilePicture"},i.a.createElement("div",{className:"profileIcons"},i.a.createElement("input",{accept:"image/*",className:"inputUploadPicture",type:"file",id:"profileImage",onChange:function(t){return e.handleImageSelected(t.target.files[0])}}),i.a.createElement("label",{htmlFor:"profileImage"},i.a.createElement(M.a,{color:"primary","aria-label":"upload picture",component:"span"},i.a.createElement(ge.a,null))),u&&i.a.createElement(M.a,{color:"primary","aria-label":"upload picture",onClick:function(){return e.handleRemoveProfilePicture()},component:"span"},i.a.createElement(be.a,null))),u&&i.a.createElement("img",{className:"profilePicture",src:u}))),i.a.createElement("div",{className:"formSubmit"},i.a.createElement(F.a,{variant:"contained",color:"primary",className:"submitButton",onClick:this.handleRegister},"Register")))}}]),t}(r.Component),Se=Object(c.b)((function(e){return{userAuthenticated:e.userAuthenticated}}))(Oe);!function(e){e[e.Login=0]="Login",e[e.Register=1]="Register"}(Pe||(Pe={}));var ye,we=function(e){function t(e){var a;return Object(S.a)(this,t),(a=Object(w.a)(this,Object(T.a)(t).call(this,e))).authenticationCanBeChanged=function(){void 0!==b.getState().userAuthenticated&&a.props.history.push(it.HOME)},a.state={selectedTab:Pe.Login},b.subscribe(a.authenticationCanBeChanged),a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"setSelectedTab",value:function(e){this.setState({selectedTab:e})}},{key:"renderActiveTab",value:function(){switch(this.state.selectedTab){case Pe.Login:return i.a.createElement(le,null);case Pe.Register:return i.a.createElement(Se,null);default:return i.a.createElement("h1",null,"Falha no sistema")}}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"login-container"},this.renderActiveTab(),i.a.createElement(N.a,{square:!0,className:"bottomTabs"},i.a.createElement(A.a,{value:this.state.selectedTab,onChange:function(t,a){return e.setSelectedTab(a)},indicatorColor:"primary",textColor:"primary",centered:!0,"aria-label":"icon label tabs example"},i.a.createElement(C.a,{value:Pe.Login,label:"Login"}),i.a.createElement(C.a,{value:Pe.Register,label:"Create account"}))))}}]),t}(r.Component),Te=(a(137),a(198)),ke=a(207),Ne=a(208),Ae=a(52),Ce=a(210);a(138);!function(e){e[e.PUBLIC=0]="PUBLIC",e[e.PRIVATE=1]="PRIVATE"}(ye||(ye={}));var Ie,xe=function(){function e(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ye.PUBLIC,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(S.a)(this,e),this.id="",this.user=void 0,this._date=void 0,this._inverseDate=void 0,this.content=void 0,this.history=void 0,this.visibility=void 0,this.hasPicture=void 0,this.userStr=void 0,this.user=t,this.userStr=t.id,this._date=a,this._inverseDate=-a.getTime(),this.content=n,this.visibility=r,this.hasPicture=i,this.history=new Array}return Object(y.a)(e,[{key:"setDate",value:function(e){this._date=e,this._inverseDate=-e.getTime()}},{key:"getDate",value:function(){return this._date}},{key:"getUpdatable",value:function(){return{id:this.id,user:this.userStr,date:this._date.getTime(),inverseDate:this._inverseDate,content:this.content,visibility:this.visibility,history:this.history,hasPicture:this.hasPicture}}}],[{key:"getPost",value:function(){var t=Object(L.a)(x.a.mark((function t(a){var n,r,i,s,o,c,l,u=arguments;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u.length>1&&void 0!==u[1]&&u[1],u.length>2&&void 0!==u[2]&&u[2],n=a.id,r=a.user,i=new Date(a.date),s=a.content,o=a.visibility,c=a.history?Object.keys(a.history).map((function(e){return a.history[e]})):new Array,l=a.hasPicture,t.abrupt("return",new Promise(function(){var t=Object(L.a)(x.a.mark((function t(a,u){var d,m;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ie.getUser(r);case 2:d=t.sent,(m=new e(d,i,s,o,l)).id=n,m.userStr=r,m.history=c,a(m);case 8:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}(),Le=function(){function e(){Object(S.a)(this,e)}return Object(y.a)(e,null,[{key:"createPost",value:function(){var e=Object(L.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(),e.next=3,te.database().ref("posts").push();case 3:return a=e.sent,t.id=a.key,e.next=7,te.database().ref("posts/"+a.key).update(t.getUpdatable());case 7:return e.abrupt("return",new Promise((function(e,t){return e(a.key)})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBaseQuery",value:function(){return te.database().ref("posts/").orderByChild("inverseDate")}},{key:"getAvailablePosts",value:function(e){var t=this;return $(),new Promise((function(a,n){t.getBaseQuery().once("value",(function(n){t.getPostsFromDataSnapshot(n,e).then((function(e){a(e)}))}))}))}},{key:"getPostsFromDataSnapshot",value:function(e,t){return new Promise((function(a,n){var r=new Array;e.forEach((function(e){var a=e.exportVal().visibility===ye.PUBLIC,n=e.exportVal().user===t;(a||n)&&r.push(new Promise((function(t,a){xe.getPost(e.exportVal()).then((function(e){t(e)}))})))})),Promise.all(r).then((function(e){a(e)}))}))}},{key:"deletePost",value:function(e){return $(),new Promise((function(t){te.database().ref("posts/"+e).remove().then((function(){t()}))}))}},{key:"updatePost",value:function(e){return $(),new Promise(function(){var t=Object(L.a)(x.a.mark((function t(a){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,te.database().ref("posts/"+e.id).update(e.getUpdatable());case 2:a();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}]),e}();!function(e){e[e.POST_CONTENT=0]="POST_CONTENT"}(Ie||(Ie={}));var Re,Fe=function(e){function t(e){var a;for(var n in Object(S.a)(this,t),(a=Object(w.a)(this,Object(T.a)(t).call(this,e))).errorMessages=new Map,a.displayError=function(e){return a.displayHelperText(e).length>0},a.setHelpersText=function(){var e="";e="",0===a.state.postContent.length&&(e="Post content required"),a.errorMessages.set(Ie.POST_CONTENT,e)},a.displayHelperText=function(e){return a.state.submitted?a.errorMessages.get(e):""},a.handlePost=Object(L.a)(x.a.mark((function e(){var t,n,r,i,s,o,c,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({submitted:!0}),t=!1,a.errorMessages.forEach((function(e,a){t||(t=e.length>0)})),t||(n=a.state,r=n.postContent,i=n.visibility,s=n.pictureFile,o=b.getState().userAuthenticated,c=void 0!==s,l=new xe(o,new Date,r,i,c),Le.createPost(l).then((function(e){c&&fe.uploadPostImage(e,s),a.props.dispatch(m(l)),a.setState({submitted:!1,showSnackBar:!0,postContent:"",pictureFile:void 0,picturePreviewURL:""})})));case 4:case"end":return e.stop()}}),e)}))),a.setPostContent=function(e){return a.setState({postContent:e})},a.setVisibility=function(e){return a.setState({visibility:e})},a.handleCloseSnackBar=function(){return a.setState({showSnackBar:!1})},a.handleImageSelected=function(e){if(e){var t=new FileReader;t.onloadend=function(){a.setState({pictureFile:e,picturePreviewURL:t.result})},t.readAsDataURL(e)}},a.handleCancelPicture=function(){a.setState({pictureFile:void 0,picturePreviewURL:""})},a.state={submitted:!1,visibility:ye.PRIVATE,postContent:"",showSnackBar:!1,textFieldFocused:!1,pictureFile:void 0,picturePreviewURL:""},Ie)a.errorMessages.set(parseInt(n),"");return a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.visibility,n=t.postContent,r=t.showSnackBar,s=t.textFieldFocused,o=t.picturePreviewURL;return this.setHelpersText(),i.a.createElement("div",{className:"createPostContainer"},i.a.createElement(z,{variant:E.SUCCESS,handleClose:this.handleCloseSnackBar,show:r,text:"Post created"}),i.a.createElement("div",{className:"contentArea"},i.a.createElement(R.a,{id:"outlined-multiline-static",label:"What's going on?",multiline:!0,rows:s||n.length>0?"4":"1",onFocus:function(){return e.setState({textFieldFocused:!0})},onBlur:function(){return e.setState({textFieldFocused:!1})},value:n,onChange:function(t){return e.setPostContent(t.target.value)},margin:"normal",variant:"outlined",error:this.displayError(Ie.POST_CONTENT),helperText:this.displayHelperText(Ie.POST_CONTENT)})),i.a.createElement("div",{className:"bottomButtons"},i.a.createElement("div",{className:"postUploadPicture"},i.a.createElement("div",{className:"postUploadButtons"},i.a.createElement("input",{accept:"image/*",className:"inputUploadPicture",type:"file",id:"createPost-inputImage",onChange:function(t){return e.handleImageSelected(t.target.files[0])}}),i.a.createElement("label",{htmlFor:"createPost-inputImage"},i.a.createElement(M.a,{color:"primary","aria-label":"upload picture",component:"span"},i.a.createElement(ge.a,null))),o&&i.a.createElement(M.a,{"aria-label":"cancel upload picture",onClick:this.handleCancelPicture,component:"span"},i.a.createElement(be.a,null))),o&&i.a.createElement("img",{className:"postPicture",src:o})),i.a.createElement("div",{className:"postButtonOptions"},i.a.createElement(me.a,{variant:"outlined",className:"formChooseVisibility"},i.a.createElement(pe.a,{labelId:"demo-simple-select-error-label",id:"demo-simple-select-error",value:a,onChange:function(t){return e.setVisibility(t.target.value)}},i.a.createElement(ue.a,{value:ye.PRIVATE},"Only friends"),i.a.createElement(ue.a,{value:ye.PUBLIC},"Public"))),i.a.createElement(F.a,{variant:"contained",color:"primary",onClick:this.handlePost,className:"formSubmit"},"Post"))))}}]),t}(r.Component),De=Object(c.b)((function(e){return{}}))(Fe),je=(a(139),a(203)),Me=a(204),Ue=a(205),_e=a(206),Be=a(213),He=a(202),We=a(200),Ve=a(201),Ge=a(199),qe=function e(t,a){Object(S.a)(this,e),this.date=void 0,this.content=void 0,this.date=t,this.content=a},Ze=a(98),Xe=a.n(Ze),ze=a(96),Ye=a.n(ze),Je=a(97),Ke=a.n(Je),Qe=a(95),$e=a.n(Qe);!function(e){e[e.POST_CONTENT=0]="POST_CONTENT"}(Re||(Re={}));var et,tt=function(e){function t(e){var a;return Object(S.a)(this,t),(a=Object(w.a)(this,Object(T.a)(t).call(this,e))).componentDidMount=Object(L.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.userAvatar();case 2:t=e.sent,a.setState({userAvatar:t});case 4:case"end":return e.stop()}}),e)}))),a.componentWillMount=function(){var e=a.props.post;e.hasPicture&&fe.downloadPostImage(e.id).then((function(e){a.setState({picturePreviewURL:e})}))},a.handleEdit=function(){a.setState({editingPost:!0,editingText:a.props.post.content})},a.handleOpenDeleteDialog=function(){a.state.editingPost||a.setState({displayDeleteDialog:!0})},a.handleCloseDeleteDialog=function(){a.state.editingPost||a.setState({displayDeleteDialog:!1})},a.handleSaveEdit=Object(L.a)(x.a.mark((function e(){var t,n,r,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.editingText,r=t.hasPicture,!(n.length>0)){e.next=12;break}return a.handleCancelEdit(),(i=a.props.post).history.push(new qe(i.getDate(),i.content)),i.content=n,i.setDate(new Date),i.hasPicture=r,r||fe.deletePostImage(i.id),e.next=11,Le.updatePost(i);case 11:a.props.dispatch(h(i));case 12:case"end":return e.stop()}}),e)}))),a.handleCancelEdit=function(){a.state.editingPost&&a.setState({editingPost:!1})},a.confirmDelete=function(){a.handleCloseDeleteDialog();var e=a.props.post;Le.deletePost(e.id).then((function(){fe.deletePostImage(e.id),a.props.dispatch(function(e){var t=b.getState().posts,a=t.indexOf(e);return t.splice(a,1),{type:n.DELETE_POST,posts:t}}(e))}))},a.displayError=function(e){return a.displayHelperText(e).length>0},a.displayHelperText=function(e){var t=a.state,n=t.editingPost,r=t.editingText;return n&&0===r.length?"Post content required":""},a.handleDeletePicture=function(){var e=a.props.post.id;a.setState({picturePreviewURL:"",hasPicture:!1},(function(){fe.deletePostImage(e),a.handleSaveEdit()}))},a.handleChangePicture=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=new FileReader;n.onloadend=function(){a.setState({picturePreviewURL:n.result,hasPicture:!!t||a.state.hasPicture}),a.handleSaveEdit()};var r=a.props.post.id;fe.uploadPostImage(r,e),n.readAsDataURL(e)}},a.postImage_hasImageAndEditing=function(e){return i.a.createElement("div",{className:"editingImagePost"},i.a.createElement("img",{className:"postPicture",src:e}),i.a.createElement("div",{className:"postImageEditingButtons"},i.a.createElement(M.a,{"aria-label":"cancel upload picture",onClick:a.handleDeletePicture,component:"span"},i.a.createElement(be.a,null)),i.a.createElement("input",{accept:"image/*",className:"inputUploadPicture",type:"file",id:"post-inputImage",onChange:function(e){return a.handleChangePicture(e.target.files[0])}}),i.a.createElement("label",{htmlFor:"post-inputImage"},i.a.createElement(M.a,{color:"primary","aria-label":"upload picture",component:"span"},i.a.createElement($e.a,null)))))},a.postImage_hasntImageAndEditing=function(){return i.a.createElement("div",null,i.a.createElement("input",{accept:"image/*",className:"inputUploadPicture",type:"file",id:"post-insertNewImage",onChange:function(e){return a.handleChangePicture(e.target.files[0],!0)}}),i.a.createElement("label",{htmlFor:"post-insertNewImage"},i.a.createElement(M.a,{color:"primary","aria-label":"upload picture",component:"span"},i.a.createElement(ge.a,null))))},a.postImage_hasImageAndNotEditing=function(e){return i.a.createElement("img",{className:"postPicture",src:e})},a.userAvatar=function(){var e=a.props.post.user;return new Promise((function(t){e.hasImage?fe.downloadUserImage(e.id).then((function(a){t(i.a.createElement(Te.a,{alt:e.getFirstLetter(),src:a}))})):t(i.a.createElement(Te.a,{"aria-label":"recipe"}," ",e.getFirstLetter()," "))}))},a.state={displayDeleteDialog:!1,editingPost:!1,editingText:"",picturePreviewURL:"",hasPicture:a.props.post.hasPicture,userAvatar:void 0},a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.post,n=t.userAuthenticated,r=this.state,s=r.displayDeleteDialog,o=r.editingPost,c=r.editingText,l=r.picturePreviewURL,u=r.userAvatar,d=null;return d=o?l.length>0?this.postImage_hasImageAndEditing(l):this.postImage_hasntImageAndEditing():this.postImage_hasImageAndNotEditing(l),i.a.createElement("div",{className:"postContainer"},i.a.createElement(Be.a,{open:s,onClose:this.handleCloseDeleteDialog,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement(Ge.a,{id:"alert-dialog-title"},"Confirm deletion of post?"),i.a.createElement(We.a,null,i.a.createElement(Ve.a,{id:"alert-dialog-description"},"This action cannot be undone.")),i.a.createElement(He.a,null,i.a.createElement(F.a,{onClick:this.handleCloseDeleteDialog,color:"primary"},"No"),i.a.createElement(F.a,{onClick:this.confirmDelete,color:"primary",autoFocus:!0},"Yes"))),i.a.createElement(je.a,{className:"cardContainer"},i.a.createElement(Me.a,{avatar:u,title:a.user.getFullName(),subheader:Y.formatDate(a.getDate(),!0)}),i.a.createElement(Ue.a,null,o?i.a.createElement("div",{className:"editTextField"},i.a.createElement(R.a,{value:c,multiline:!0,error:this.displayError(Re.POST_CONTENT),helperText:this.displayHelperText(Re.POST_CONTENT),onChange:function(t){return e.setState({editingText:t.target.value})}}),d):i.a.createElement("div",{className:"postContent"},a.content,d)),n&&n.id===a.userStr&&i.a.createElement(_e.a,{disableSpacing:!0,className:"cardActions"},i.a.createElement("div",{className:"cardActions"},i.a.createElement(M.a,{onClick:this.handleEdit,"aria-label":"edit"},i.a.createElement(Ye.a,null)),i.a.createElement(M.a,{onClick:this.handleOpenDeleteDialog,"aria-label":"delete"},i.a.createElement(Ke.a,null))),o&&i.a.createElement("div",{className:"onlyEditingCardActions"},i.a.createElement(M.a,{onClick:this.handleSaveEdit,"aria-label":"delete"},i.a.createElement(Xe.a,null)),i.a.createElement(M.a,{onClick:this.handleCancelEdit,"aria-label":"delete"},i.a.createElement(be.a,null))))))}}]),t}(r.Component),at=Object(c.b)((function(e){return{userAuthenticated:e.userAuthenticated}}))(tt),nt=a(99),rt=a.n(nt);!function(e){e[e.AllPosts=0]="AllPosts",e[e.Public=1]="Public",e[e.Private=2]="Private",e[e.My=3]="My",e[e.FromOther=4]="FromOther"}(et||(et={}));var it,st=function(e){function t(e){var a;return Object(S.a)(this,t),(a=Object(w.a)(this,Object(T.a)(t).call(this,e))).componentDidMount=Object(L.a)(x.a.mark((function e(){var t,n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b.getState().userAuthenticated){e.next=7;break}if(!(t=localStorage.getItem("@SocialNetwork/uid"))){e.next=7;break}return e.next=5,ie.getUser(t);case 5:n=e.sent,a.props.dispatch(d(n));case 7:return e.next=9,a.userAvatar();case 9:r=e.sent,a.setState({userAvatar:r}),a.loadPostsFromDB();case 12:case"end":return e.stop()}}),e)}))),a.loadPostsFromDB=Object(L.a)(x.a.mark((function e(){var t,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.userAuthenticated,e.next=3,Le.getAvailablePosts(t?t.id:"");case 3:n=e.sent,a.props.dispatch(p(n)),a.loadPostsAccordingToViewOption();case 6:case"end":return e.stop()}}),e)}))),a.handleLogoff=function(){localStorage.removeItem("@SocialNetwork/uid"),a.props.dispatch({type:n.LOGOFF}),a.props.history.push(it.LOGIN)},a.loadPostsAccordingToViewOption=function(){var e=a.props,t=e.posts,n=e.userAuthenticated,r=a.state.viewOption,i=new Array;switch(r){case et.AllPosts:i=t;break;case et.My:i=t.filter((function(e){return e.userStr===n.id}));break;case et.Private:i=t.filter((function(e){return e.visibility===ye.PRIVATE}));break;case et.Public:i=t.filter((function(e){return e.visibility===ye.PUBLIC}));break;case et.FromOther:i=t.filter((function(e){return e.userStr!==n.id}))}a.setState({posts:i})},a.setViewOption=function(e){a.setState({viewOption:e},(function(){return a.loadPostsAccordingToViewOption()}))},a.userAvatar=function(){var e=a.props.userAuthenticated;return new Promise((function(t){e.hasImage?fe.downloadUserImage(e.id).then((function(a){t(i.a.createElement(Te.a,{alt:e.getFirstLetter(),src:a}))})):t(i.a.createElement(Te.a,{"aria-label":"recipe"}," ",e.getFirstLetter()," "))}))},a.state={viewOption:et.AllPosts,posts:new Array,userAvatar:void 0},a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.props.userAuthenticated,a=this.state,n=a.viewOption,r=a.posts,s=a.userAvatar,o=r.map((function(e,t){return i.a.createElement(at,{key:e.id,post:e})}));return i.a.createElement("div",{className:"homePageContainer"},t&&i.a.createElement("div",{className:"onlyAuthenticated"},i.a.createElement("div",{className:"headerContainer"},i.a.createElement("div",{className:"profileContainer"},s,i.a.createElement("div",{className:"profileName"},t.getFullName())),i.a.createElement(F.a,{variant:"contained",color:"secondary",onClick:this.handleLogoff,startIcon:i.a.createElement(rt.a,null)},"Logoff")),i.a.createElement(De,null)),i.a.createElement(ke.a,{position:"static"},i.a.createElement(Ne.a,null,i.a.createElement("div",{className:"appToolbar"},i.a.createElement("div",null,i.a.createElement(Ae.a,{variant:"h5"},"Timeline")),i.a.createElement("div",{className:"viewOptions"},i.a.createElement(se.a,{value:"start",control:i.a.createElement(Ce.a,{onClick:function(){return e.setViewOption(et.AllPosts)},checked:n===et.AllPosts}),label:"All posts",labelPlacement:"start"}),i.a.createElement(se.a,{value:"start",control:i.a.createElement(Ce.a,{onClick:function(){return e.setViewOption(et.Public)},checked:n===et.Public}),label:"Public posts",labelPlacement:"start"}),i.a.createElement(se.a,{disabled:void 0===t,value:"start",control:i.a.createElement(Ce.a,{onClick:function(){return e.setViewOption(et.Private)},checked:n===et.Private}),label:"Private posts",labelPlacement:"start"}),i.a.createElement(se.a,{disabled:void 0===t,value:"start",control:i.a.createElement(Ce.a,{onClick:function(){return e.setViewOption(et.My)},checked:n===et.My}),label:"My posts",labelPlacement:"start"}),i.a.createElement(se.a,{disabled:void 0===t,value:"start",control:i.a.createElement(Ce.a,{onClick:function(){return e.setViewOption(et.FromOther)},checked:n===et.FromOther}),label:"From another",labelPlacement:"start"}))))),o)}}]),t}(r.Component),ot=Object(c.b)((function(e){return{posts:e.posts,userAuthenticated:e.userAuthenticated}}))(st);a(140);function ct(){return i.a.createElement("h1",null,"Hello World! Profile")}function lt(){return i.a.createElement("h1",{style:{textAlign:"center"}},"Page not Found",i.a.createElement("br",null),i.a.createElement(P.b,{to:"/"},"Go to Home "))}!function(e){e.LOGIN="/login",e.HOME="/home",e.PROFILE="/profile"}(it||(it={}));a(142);o.a.render(i.a.createElement((function(){return i.a.createElement(c.a,{store:b},i.a.createElement(P.a,{basename:"/SocialNetwork"},i.a.createElement(O.c,null,i.a.createElement(O.a,{path:"/",exact:!0,component:we}),i.a.createElement(O.a,{path:it.LOGIN,component:we}),i.a.createElement(O.a,{path:it.HOME,component:ot}),i.a.createElement(O.a,{path:it.PROFILE,component:ct}),i.a.createElement(O.a,{component:lt}))))}),null),document.getElementById("root"))},76:function(e,t,a){}},[[114,1,2]]]);
//# sourceMappingURL=main.fff8da7c.chunk.js.map